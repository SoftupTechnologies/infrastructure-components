AWSTemplateFormatVersion: 2010-09-09
Description: "Stack for S3 bucket where artifacts will be stored"

Parameters:
  ProjectName:
    Description: Name of the project
    Type: String
  ClientName:
    Description: Client name
    Type: String
  Environment:
    Description: Name of the stack environment
    Type: String
    AllowedValues:
      - dev
      - stage
      - prod

Resources:
  ArtifactsBucket:
    Type: AWS::S3::Bucket
    Properties:
      BucketName: !Sub ${ProjectName}-artifacts-${Environment}
      PublicAccessBlockConfiguration: 
        RestrictPublicBuckets: true
        BlockPublicAcls: true
        BlockPublicPolicy: true
        IgnorePublicAcls: true
      Tags:
        - Key: cost-center
          Value: !Ref ClientName
        - Key: project
          Value: !Ref ProjectName
    DeletionPolicy: Retain

Outputs:
  BucketName:
    Value: !Ref 'ArtifactsBucket'
    Description: Bucket that holds authorized keys